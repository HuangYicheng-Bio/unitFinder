# unitFinder
De novo discovery of CentGm sequences
The methods and procedures for identifying CentGm sequences and generating statistical charts have been packaged into the unitFinder software. This tool can perform de novo identification by inputting a single chromosome sequence via the --seq parameter, or reference-based identification by supplying potential satellite repeat sequences via the --cen parameter. The detailed steps are as follows:
First, we located the potential centromere regions by finding the tandem repeats sequences (Fig. S1b, Table S1). Tandem Repeats Finder was used to find tandem repeat sequences (TRSs) which contain CentGm sequences with parameters “2 7 7 80 10 50 500 -f -d -m”. We employed an iterative approach to ensure the detection of shorter tandem repeats within higher-order TRSs (Fig. S2). Using unitFinder to identify potential satellites without reference, the repeated command is as follows: “python unitFinder.py --seq Chr*.fasta --name Chr*”.
After finding the smallest TRS in potential centromeric regions, we used nucmer with parameter “-c 10 -l 10” to align the TRS to each other, and the TRS with identity>=50.0 and coverage  80% will be grouped as the same TRS. We grouped the TRSs based on sequence similarity, and those present across all chromosomes were considered as the potential CentGm sequences (Fig. S2a, Table S1). Results from each chromosome were merged and potential CentGm sequences identified using scripts typeMerge_type_raw.py and getChrTypeFromMerge.py, respectively.
Finally, we reidentified the potential centromere regions by aligning potential CentGm sequences to the genome to find TRSs within these regions (Fig. S2b, Table S1) and using unitFinder command as follows: “python unitFinder.py --seq  Chr*.fasta --name Chr* --cen *.subtype.fa”. The TRSs shared in all chromosomes were considered as the CentGm sequences.

#Analyze the satellite repeat units of each chromosome
python ../bin/unitFinder.py --seq ./Chr*.fasta --name Chr*
##If CentGm sequence is known to be input via the --cen parameter.
python ../bin/unitFinder.py --seq ./Chr*.fasta --name Chr* --cen *.subtype.fa

#Analyze the shared centromeric satellite repeat monomers (use ZH13 as example)
cat ../Chr*/Chr*.Type.fa >ZH13.Type.fa
cat ../Chr*/Chr*.Type.units.fa >ZH13.Type.units.fa
cat ../Chr*/Chr*.Consensus.uniq.fa >ZH13.Consensus.uniq.fa
cat ../Chr*/Chr*.Consensus.uniq.grouped.txt >ZH13.uniq.grouped.txt
cat ../Chr*/Chr*.Units.uniq.fa >ZH13.Units.uniq.fa

python ../bin/typeMerge_type.py --in ZH13.Type.fa --out ZH13.Type.grouped.txt --name ZH13.Type

#Modify the ./unify/change.stat.py file to alter the output format.
python ./unify/change.stat.py

python ../bin/getChrTypeFromMerge.py --in ZH13.Type.fa --unit ZH13.Type.units.fa --type ZH13.Type.grouped.txt --name ZH13.Type.raw
python ../bin/getChrTypeFromMerge.py --in ZH13.Consensus.uniq.fa --unit ZH13.Units.uniq.fa --type ZH13.Type.grouped.all.txt --name ZH13.Type.All

#Generation of HF-CentGm sequences and Representative CentGm
##Obtain the satellite repeat sequence monomers present in each chromosome from the *.Type.All.Type.All.fa file.
##CentGm-1
cat ZH13.Type.All.Type.All.fa | grep -A 1 'Type-4' >CentGm-1.fa
python complete-Gm1.unit.py
clustalo -i CentGm-1-stan.fa -o CentGM1.fa -v --force
##Modify the ./unify/unify.py file to generate representative CentGm.
python ./unify/unify.py

##CentGm-4
cat ZH13.Type.All.Type.All.fa | grep -A 1 'Type-3' >CentGm-4.fa
python complete-Gm4.unit.py
clustalo -i CentGm-4-stan.fa -o CentGM4.fa -v --force
python ./unify/unify.py

#Align all CentGm monomers to a common start point based on the representative CentGm sequences.
##./ref/Chr*.loci.fa, ../ref/Chr*.Units.uniq.fa, ../ref/Chr*.Consensus.uniq.fa was generated by unitFinder.py
##../../Type/CentGm-1.type.fa and ../../Type/CentGm-4.type.fa was generated by ./unify/unify.py
python ../standards/getType.py --in ../ref/Chr*.loci.fa --unit ../ref/Chr*.Units.uniq.fa --type1 ../../Type/CentGm-1.type.fa --type4 ../../Type/CentGm-4.type.fa --name Chr20 --con ../ref/Chr*.Consensus.uniq.fa --RM ../RepeatMasker/GWHBWDJ00000000.1.genome.fasta.out
